{{- $giscus := site.Params.giscus -}}
{{- if and $giscus $giscus.enable -}}
  {{- $repo := $giscus.repo | default "" -}}
  {{- $repoId := $giscus.repoId | default "" -}}
  {{- $category := $giscus.category | default "" -}}
  {{- $categoryId := $giscus.categoryId | default "" -}}
  {{- if and $repo $repoId $category $categoryId -}}
<div class="giscus-comments" style="margin: 2rem 0 0;">
  <script
    src="https://giscus.app/client.js"
    data-repo="{{ $repo }}"
    data-repo-id="{{ $repoId }}"
    data-category="{{ $category }}"
    data-category-id="{{ $categoryId }}"
    data-mapping="{{ $giscus.mapping | default "pathname" }}"
    data-strict="{{ $giscus.strict | default "0" }}"
    data-reactions-enabled="{{ $giscus.reactionsEnabled | default "1" }}"
    data-emit-metadata="{{ $giscus.emitMetadata | default "0" }}"
    data-input-position="{{ $giscus.inputPosition | default "bottom" }}"
    data-theme="{{ $giscus.theme | default "preferred_color_scheme" }}"
    data-lang="{{ $giscus.lang | default "zh-CN" }}"
    crossorigin="anonymous"
    async>
  </script>
</div>
  {{- else if hugo.IsServer -}}
<div style="margin-top: 1rem; padding: .75rem 1rem; border: 1px solid #d9a441; border-radius: 6px;">
  Giscus is enabled but not fully configured. Please set <code>params.giscus.categoryId</code>.
</div>
  {{- end -}}
{{- end -}}
