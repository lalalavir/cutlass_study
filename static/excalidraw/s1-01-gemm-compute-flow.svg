<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="813" height="612" viewBox="-4 0 813 612">
<defs><marker id="arrow-4a9eed" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#4a9eed" /></marker><marker id="arrow-8b5cf6" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#8b5cf6" /></marker><marker id="arrow-22c55e" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#22c55e" /></marker></defs>
<rect x="-4" y="0" width="813" height="612" fill="#ffffff" />
<g opacity="1"><text font-family="Segoe UI, Arial, sans-serif" font-size="28" fill="#1e1e1e" text-anchor="start" dominant-baseline="hanging"><tspan x="160" y="24">01 最小 GEMM 计算流程（CUTLASS）</tspan></text></g>
<g opacity="1"><text font-family="Segoe UI, Arial, sans-serif" font-size="16" fill="#757575" text-anchor="start" dominant-baseline="hanging"><tspan x="136" y="60">输入准备 -&gt; Device GEMM -&gt; Host 参考验证</tspan></text></g>
<rect x="20" y="95" width="760" height="130" rx="12" ry="12" stroke="#4a9eed" stroke-width="1" fill="#dbe4ff" opacity="0.3" />
<g opacity="1"><text font-family="Segoe UI, Arial, sans-serif" font-size="18" fill="#2563eb" text-anchor="start" dominant-baseline="hanging"><tspan x="34" y="103">阶段 1：输入与数据准备</tspan></text></g>
<rect x="25" y="125" width="170" height="78" rx="12" ry="12" stroke="#1e1e1e" stroke-width="2" fill="#a5d8ff" opacity="1" /><text font-family="Segoe UI, Arial, sans-serif" font-size="16" fill="#1e1e1e" text-anchor="middle" dominant-baseline="hanging"><tspan x="110" y="144">1. 问题规模</tspan><tspan x="110" y="164">M / N / K, α / β</tspan></text>
<polyline points="195,164 220,164" fill="none" stroke="#4a9eed" stroke-width="2" opacity="1" marker-end="url(#arrow-4a9eed)" />
<rect x="220" y="125" width="170" height="78" rx="12" ry="12" stroke="#1e1e1e" stroke-width="2" fill="#ffd8a8" opacity="1" /><text font-family="Segoe UI, Arial, sans-serif" font-size="16" fill="#1e1e1e" text-anchor="middle" dominant-baseline="hanging"><tspan x="305" y="144">2. HostTensor</tspan><tspan x="305" y="164">A/B/C_cutlass/C_ref</tspan></text>
<polyline points="390,164 415,164" fill="none" stroke="#4a9eed" stroke-width="2" opacity="1" marker-end="url(#arrow-4a9eed)" />
<rect x="415" y="125" width="170" height="78" rx="12" ry="12" stroke="#1e1e1e" stroke-width="2" fill="#c3fae8" opacity="1" /><text font-family="Segoe UI, Arial, sans-serif" font-size="16" fill="#1e1e1e" text-anchor="middle" dominant-baseline="hanging"><tspan x="500" y="144">3. Device 初始化</tspan><tspan x="500" y="164">TensorFillRandomGaussian</tspan></text>
<polyline points="585,164 610,164" fill="none" stroke="#4a9eed" stroke-width="2" opacity="1" marker-end="url(#arrow-4a9eed)" />
<rect x="610" y="125" width="170" height="78" rx="12" ry="12" stroke="#1e1e1e" stroke-width="2" fill="#d0bfff" opacity="1" /><text font-family="Segoe UI, Arial, sans-serif" font-size="16" fill="#1e1e1e" text-anchor="middle" dominant-baseline="hanging"><tspan x="695" y="144">4. 复制基线 C</tspan><tspan x="695" y="164">C_ref &lt;- C_cutlass</tspan></text>
<rect x="20" y="240" width="760" height="130" rx="12" ry="12" stroke="#8b5cf6" stroke-width="1" fill="#e5dbff" opacity="0.3" />
<g opacity="1"><text font-family="Segoe UI, Arial, sans-serif" font-size="18" fill="#6d28d9" text-anchor="start" dominant-baseline="hanging"><tspan x="34" y="248">阶段 2：CUTLASS Device GEMM</tspan></text></g>
<polyline points="695,203 110,270" fill="none" stroke="#8b5cf6" stroke-width="2" opacity="1" marker-end="url(#arrow-8b5cf6)" /><text font-family="Segoe UI, Arial, sans-serif" font-size="14" fill="#8b5cf6" text-anchor="middle" dominant-baseline="hanging"><tspan x="402.5" y="226.5">进入 cutlass_hgemm_nn</tspan></text>
<rect x="25" y="270" width="170" height="78" rx="12" ry="12" stroke="#1e1e1e" stroke-width="2" fill="#d0bfff" opacity="1" /><text font-family="Segoe UI, Arial, sans-serif" font-size="16" fill="#1e1e1e" text-anchor="middle" dominant-baseline="hanging"><tspan x="110" y="289">5. 定义 Gemm</tspan><tspan x="110" y="309">device::Gemm&lt;...&gt;</tspan></text>
<polyline points="195,309 220,309" fill="none" stroke="#8b5cf6" stroke-width="2" opacity="1" marker-end="url(#arrow-8b5cf6)" />
<rect x="220" y="270" width="170" height="78" rx="12" ry="12" stroke="#1e1e1e" stroke-width="2" fill="#a5d8ff" opacity="1" /><text font-family="Segoe UI, Arial, sans-serif" font-size="16" fill="#1e1e1e" text-anchor="middle" dominant-baseline="hanging"><tspan x="305" y="289">6. 构造 Arguments</tspan><tspan x="305" y="309">{M,N,K},{A,lda}...</tspan></text>
<polyline points="390,309 415,309" fill="none" stroke="#8b5cf6" stroke-width="2" opacity="1" marker-end="url(#arrow-8b5cf6)" />
<rect x="415" y="270" width="170" height="78" rx="12" ry="12" stroke="#1e1e1e" stroke-width="2" fill="#b2f2bb" opacity="1" /><text font-family="Segoe UI, Arial, sans-serif" font-size="16" fill="#1e1e1e" text-anchor="middle" dominant-baseline="hanging"><tspan x="500" y="289">7. 启动计算</tspan><tspan x="500" y="309">gemm_op(arguments)</tspan></text>
<polyline points="585,309 610,309" fill="none" stroke="#8b5cf6" stroke-width="2" opacity="1" marker-end="url(#arrow-8b5cf6)" />
<rect x="610" y="270" width="170" height="78" rx="12" ry="12" stroke="#1e1e1e" stroke-width="2" fill="#fff3bf" opacity="1" /><text font-family="Segoe UI, Arial, sans-serif" font-size="16" fill="#1e1e1e" text-anchor="middle" dominant-baseline="hanging"><tspan x="695" y="289">8. 状态检查</tspan><tspan x="695" y="309">status == kSuccess ?</tspan></text>
<rect x="20" y="385" width="760" height="175" rx="12" ry="12" stroke="#22c55e" stroke-width="1" fill="#d3f9d8" opacity="0.3" />
<g opacity="1"><text font-family="Segoe UI, Arial, sans-serif" font-size="18" fill="#15803d" text-anchor="start" dominant-baseline="hanging"><tspan x="34" y="393">阶段 3：Host 参考结果与一致性校验</tspan></text></g>
<polyline points="695,348 110,443" fill="none" stroke="#22c55e" stroke-width="2" opacity="1" marker-end="url(#arrow-22c55e)" /><text font-family="Segoe UI, Arial, sans-serif" font-size="14" fill="#22c55e" text-anchor="middle" dominant-baseline="hanging"><tspan x="402.5" y="385.5">进入参考路径</tspan></text>
<rect x="25" y="430" width="170" height="95" rx="12" ry="12" stroke="#1e1e1e" stroke-width="2" fill="#a5d8ff" opacity="1" /><text font-family="Segoe UI, Arial, sans-serif" font-size="16" fill="#1e1e1e" text-anchor="middle" dominant-baseline="hanging"><tspan x="110" y="457.5">9. sync_host</tspan><tspan x="110" y="477.5">A/B/C_cutlass/C_ref</tspan></text>
<polyline points="195,477 220,477" fill="none" stroke="#22c55e" stroke-width="2" opacity="1" marker-end="url(#arrow-22c55e)" />
<rect x="220" y="430" width="170" height="95" rx="12" ry="12" stroke="#1e1e1e" stroke-width="2" fill="#d0bfff" opacity="1" /><text font-family="Segoe UI, Arial, sans-serif" font-size="16" fill="#1e1e1e" text-anchor="middle" dominant-baseline="hanging"><tspan x="305" y="447.5">10. host::Gemm</tspan><tspan x="305" y="467.5">计算 C_reference</tspan><tspan x="305" y="487.5">(同一公式)</tspan></text>
<polyline points="390,477 415,477" fill="none" stroke="#22c55e" stroke-width="2" opacity="1" marker-end="url(#arrow-22c55e)" />
<rect x="415" y="430" width="170" height="95" rx="12" ry="12" stroke="#1e1e1e" stroke-width="2" fill="#fff3bf" opacity="1" /><text font-family="Segoe UI, Arial, sans-serif" font-size="16" fill="#1e1e1e" text-anchor="middle" dominant-baseline="hanging"><tspan x="500" y="457.5">11. TensorEquals</tspan><tspan x="500" y="477.5">C_reference vs C_cutlass</tspan></text>
<polyline points="585,477 610,477" fill="none" stroke="#22c55e" stroke-width="2" opacity="1" marker-end="url(#arrow-22c55e)" />
<rect x="610" y="430" width="170" height="95" rx="12" ry="12" stroke="#1e1e1e" stroke-width="2" fill="#b2f2bb" opacity="1" /><text font-family="Segoe UI, Arial, sans-serif" font-size="16" fill="#1e1e1e" text-anchor="middle" dominant-baseline="hanging"><tspan x="695" y="447.5">12. 输出结果</tspan><tspan x="695" y="467.5">一致 -&gt; PASS</tspan><tspan x="695" y="487.5">不一致 -&gt; FAIL</tspan></text>
<g opacity="1"><text font-family="Segoe UI, Arial, sans-serif" font-size="16" fill="#757575" text-anchor="start" dominant-baseline="hanging"><tspan x="132" y="568">闭环：初始化 -&gt; CUTLASS 计算 -&gt; 参考计算 -&gt; 对比校验</tspan></text></g>
</svg>
